(()=>{"use strict";var e,t={87:(e,t,s)=>{const n=window.wp.blocks,r=window.wp.i18n,l=window.wp.blockEditor,a=window.wp.apiFetch;var o=s.n(a);const i=window.wp.element,p=window.wp.components,c=window.wp.coreData,u=window.wp.data,d=window.ReactJSXRuntime,h=JSON.parse('{"UU":"sim/simpagegallery"}');(0,n.registerBlockType)(h.UU,{icon:"format-gallery",edit:({setAttributes:e,attributes:t,context:s})=>{const n=t.color;let a=t.postTypes,h=JSON.parse(t.categories);const g=s.postType,[m,f]=(0,i.useState)([]),[w,x]=(0,i.useState)({}),[_,y]=(0,i.useState)((0,d.jsxs)(d.Fragment,{children:[" Loading... ",(0,d.jsx)(p.Spinner,{})," "]})),[j,b]=(0,i.useState)((0,d.jsxs)(d.Fragment,{children:[" ",(0,d.jsx)("br",{}),(0,d.jsx)(p.Spinner,{})," "]})),[v,O]=(0,i.useState)((0,d.jsxs)(d.Fragment,{children:[" ",(0,d.jsx)("br",{}),(0,d.jsx)(p.Spinner,{})," "]})),[S,C]=(0,i.useState)(!1),k=(0,u.useSelect)((e=>e(c.store).getTaxonomies({per_page:-1})),[]),T=(0,u.useSelect)((e=>e(c.store).getPostTypes({per_page:-1})),[]);return(0,i.useEffect)((()=>{if(null==T||null==k)return;let e=T.filter((e=>!["revision","nav_menu_item","custom_css","customize_changeset","oembed_cache","user_request","wp_block","wp_template","wp_template_part","wp_navigation"].includes(e.slug)));f(e);let t={...w};e.map((e=>{let s=k.filter((t=>t.types.includes(e.slug)));null==t[e.slug]&&(t[e.slug]={}),s.map((async s=>{t[e.slug][s.slug]=await o()({path:`/${s.rest_namespace}/${s.rest_base}/?per_page=100`})}))})),x(t)}),[T,k]),(0,i.useEffect)((()=>{!async function(){0!=m.length&&b(m.map((t=>(0,d.jsx)(p.CheckboxControl,{label:t.name,onChange:s=>{!function(t,s){let n=[...a];s?n.includes(t)||n.push(t):n=n.filter((e=>e!=t)),e({postTypes:n})}(t.slug,s)},checked:a.includes(t.slug)},t.slug))))}()}),[m,t.postTypes]),(0,i.useEffect)((()=>{let t=!0;if(0==Object.keys(w).length)return void O((0,d.jsx)(p.Spinner,{}));let s=[];0==a.length&&null!=w[g]&&e({postTypes:[g]}),a.forEach((n=>{if(s.push((0,d.jsx)("h2",{children:n.charAt(0).toUpperCase()+n.slice(1)})),null==w[n]||0==Object.entries(w[n]).length)return O((0,d.jsx)(p.Spinner,{})),void setTimeout(C,1e3,!S);Object.keys(w[n]).forEach((r=>{s.push(r.charAt(0).toUpperCase()+r.slice(1)),Object.values(w[n][r]).map((l=>{t=!0;try{t=h[n][r].includes(l.slug)}catch(e){t=!1}s.push((0,d.jsx)(p.CheckboxControl,{label:l.name,onChange:t=>{!function(t,s,n,r){let l={...h};null==l[t]&&(l[t]={}),null==l[t][s]&&(l[t][s]=[]),r?l[t][s].includes(n)||l[t][s].push(n):l=l[t][s].filter((e=>e!=n)),e({categories:JSON.stringify(l)})}(n,r,l.slug,t)},checked:t},l.id))}))}))})),O(s)}),[w,t.categories,t.postTypes,S]),(0,i.useEffect)((()=>{!async function(){y((0,d.jsxs)(d.Fragment,{children:[" Loading... ",(0,d.jsx)(p.Spinner,{})," "]}));const e=await o()({path:sim.restApiPrefix+"/pagegallery/show_page_gallery",method:"POST",data:{postTypes:a,amount:t.amount,categories:h,speed:t.speed,title:t.title}});y(wp.element.RawHTML({children:e}))}()}),[t]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.InspectorControls,{children:(0,d.jsxs)(p.Panel,{children:[(0,d.jsx)(p.PanelBody,{title:"Background color",initialOpen:!1,children:(0,d.jsx)(p.PanelRow,{children:(0,d.jsx)(p.ColorPicker,{color:n,onChange:t=>e({color:t}),enableAlpha:!0,defaultValue:"#000"})})}),(0,d.jsxs)(p.PanelBody,{title:"Properties",initialOpen:!1,children:[(0,d.jsx)(p.__experimentalInputControl,{label:(0,r.__)("Title","sim"),isPressEnterToChange:!0,value:t.title,onChange:t=>e({title:t})}),(0,r.__)("How many pages should be shown at once","sim"),(0,d.jsx)(p.__experimentalNumberControl,{label:(0,r.__)("Page count","sim"),value:t.amount,onChange:t=>e({amount:parseInt(t)}),min:1,max:12}),(0,d.jsx)("br",{}),(0,r.__)("How often should we refresh in seconds","sim"),(0,d.jsx)(p.__experimentalNumberControl,{label:(0,r.__)("Refresh rate","sim"),value:t.speed,onChange:t=>e({speed:parseInt(t)}),min:30}),(0,d.jsx)("br",{}),"Select the post types you want to include in the gallery:",j,(0,d.jsx)("br",{}),"Select the categories you want from any post type. Leave empty for all",v]})]})}),(0,d.jsx)("div",{...(0,l.useBlockProps)(),children:_})]})},save:()=>null})}},s={};function n(e){var r=s[e];if(void 0!==r)return r.exports;var l=s[e]={exports:{}};return t[e](l,l.exports,n),l.exports}n.m=t,e=[],n.O=(t,s,r,l)=>{if(!s){var a=1/0;for(c=0;c<e.length;c++){s=e[c][0],r=e[c][1],l=e[c][2];for(var o=!0,i=0;i<s.length;i++)(!1&l||a>=l)&&Object.keys(n.O).every((e=>n.O[e](s[i])))?s.splice(i--,1):(o=!1,l<a&&(a=l));if(o){e.splice(c--,1);var p=r();void 0!==p&&(t=p)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[s,r,l]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};n.O.j=t=>0===e[t];var t=(t,s)=>{var r,l,a=s[0],o=s[1],i=s[2],p=0;if(a.some((t=>0!==e[t]))){for(r in o)n.o(o,r)&&(n.m[r]=o[r]);if(i)var c=i(n)}for(t&&t(s);p<a.length;p++)l=a[p],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(c)},s=self.webpackChunksim_page_gallery=self.webpackChunksim_page_gallery||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var r=n.O(void 0,[350],(()=>n(87)));r=n.O(r)})();