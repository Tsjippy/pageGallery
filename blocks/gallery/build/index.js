(()=>{"use strict";var e,t={467:(e,t,l)=>{const n=window.wp.blocks,a=window.React,r=window.wp.i18n,s=window.wp.blockEditor,o=window.wp.apiFetch;var i=l.n(o);const c=window.wp.element,u=window.wp.components,p=window.wp.coreData,m=window.wp.data,g=JSON.parse('{"UU":"sim/simpagegallery"}');(0,n.registerBlockType)(g.UU,{icon:"format-gallery",edit:({setAttributes:e,attributes:t,context:l})=>{const n=t.color;let o=t.postTypes,g=JSON.parse(t.categories);const d=l.postType,[h,f]=(0,c.useState)([]),[w,y]=(0,c.useState)({}),[_,E]=(0,c.useState)((0,a.createElement)(a.Fragment,null," Loading... ",(0,a.createElement)(u.Spinner,null)," ")),[b,v]=(0,c.useState)((0,a.createElement)(a.Fragment,null," ",(0,a.createElement)("br",null),(0,a.createElement)(u.Spinner,null)," ")),[O,k]=(0,c.useState)((0,a.createElement)(a.Fragment,null," ",(0,a.createElement)("br",null),(0,a.createElement)(u.Spinner,null)," ")),[C,S]=(0,c.useState)(!1),T=(0,m.useSelect)((e=>e(p.store).getTaxonomies({per_page:-1})),[]),P=(0,m.useSelect)((e=>e(p.store).getPostTypes({per_page:-1})),[]);return(0,c.useEffect)((()=>{if(null==P||null==T)return;let e=P.filter((e=>!["revision","nav_menu_item","custom_css","customize_changeset","oembed_cache","user_request","wp_block","wp_template","wp_template_part","wp_navigation"].includes(e.slug)));f(e);let t={...w};e.map((e=>{let l=T.filter((t=>t.types.includes(e.slug)));null==t[e.slug]&&(t[e.slug]={}),l.map((async l=>{t[e.slug][l.slug]=await i()({path:`/${l.rest_namespace}/${l.rest_base}/?per_page=100`})}))})),y(t)}),[P,T]),(0,c.useEffect)((()=>{!async function(){0!=h.length&&v(h.map((t=>(0,a.createElement)(u.CheckboxControl,{label:t.name,onChange:l=>{!function(t,l){let n=[...o];l?n.includes(t)||n.push(t):n=n.filter((e=>e!=t)),e({postTypes:n})}(t.slug,l)},checked:o.includes(t.slug),key:t.slug}))))}()}),[h,t.postTypes]),(0,c.useEffect)((()=>{let t=!0;if(0==Object.keys(w).length)return void k((0,a.createElement)(u.Spinner,null));let l=[];0==o.length&&null!=w[d]&&e({postTypes:[d]}),o.forEach((n=>{if(l.push((0,a.createElement)("h2",null,n.charAt(0).toUpperCase()+n.slice(1))),null==w[n]||0==Object.entries(w[n]).length)return k((0,a.createElement)(u.Spinner,null)),void setTimeout(S,1e3,!C);Object.keys(w[n]).forEach((r=>{l.push(r.charAt(0).toUpperCase()+r.slice(1)),Object.values(w[n][r]).map((s=>{t=!0;try{t=g[n][r].includes(s.slug)}catch(e){t=!1}l.push((0,a.createElement)(u.CheckboxControl,{label:s.name,onChange:t=>{!function(t,l,n,a){let r={...g};null==r[t]&&(r[t]={}),null==r[t][l]&&(r[t][l]=[]),a?r[t][l].includes(n)||r[t][l].push(n):r=r[t][l].filter((e=>e!=n)),e({categories:JSON.stringify(r)})}(n,r,s.slug,t)},checked:t,key:s.id}))}))}))})),k(l)}),[w,t.categories,t.postTypes,C]),(0,c.useEffect)((()=>{!async function(){E((0,a.createElement)(a.Fragment,null," Loading... ",(0,a.createElement)(u.Spinner,null)," "));const e=await i()({path:sim.restApiPrefix+"/pagegallery/show_page_gallery",method:"POST",data:{postTypes:o,amount:t.amount,categories:g,speed:t.speed,title:t.title}});E(wp.element.RawHTML({children:e}))}()}),[t]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)(s.InspectorControls,null,(0,a.createElement)(u.Panel,null,(0,a.createElement)(u.PanelBody,{title:"Background color",initialOpen:!1},(0,a.createElement)(u.PanelRow,null,(0,a.createElement)(u.ColorPicker,{color:n,onChange:t=>e({color:t}),enableAlpha:!0,defaultValue:"#000"}))),(0,a.createElement)(u.PanelBody,{title:"Properties",initialOpen:!1},(0,a.createElement)(u.__experimentalInputControl,{label:(0,r.__)("Title","sim"),isPressEnterToChange:!0,value:t.title,onChange:t=>e({title:t})}),(0,r.__)("How many pages should be shown at once","sim"),(0,a.createElement)(u.__experimentalNumberControl,{label:(0,r.__)("Page count","sim"),value:t.amount,onChange:t=>e({amount:parseInt(t)}),min:1,max:12}),(0,a.createElement)("br",null),(0,r.__)("How often should we refresh in seconds","sim"),(0,a.createElement)(u.__experimentalNumberControl,{label:(0,r.__)("Refresh rate","sim"),value:t.speed,onChange:t=>e({speed:parseInt(t)}),min:30}),(0,a.createElement)("br",null),"Select the post types you want to include in the gallery:",b,(0,a.createElement)("br",null),"Select the categories you want from any post type. Leave empty for all",O))),(0,a.createElement)("div",{...(0,s.useBlockProps)()},_))},save:()=>null})}},l={};function n(e){var a=l[e];if(void 0!==a)return a.exports;var r=l[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.m=t,e=[],n.O=(t,l,a,r)=>{if(!l){var s=1/0;for(u=0;u<e.length;u++){l=e[u][0],a=e[u][1],r=e[u][2];for(var o=!0,i=0;i<l.length;i++)(!1&r||s>=r)&&Object.keys(n.O).every((e=>n.O[e](l[i])))?l.splice(i--,1):(o=!1,r<s&&(s=r));if(o){e.splice(u--,1);var c=a();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[l,a,r]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};n.O.j=t=>0===e[t];var t=(t,l)=>{var a,r,s=l[0],o=l[1],i=l[2],c=0;if(s.some((t=>0!==e[t]))){for(a in o)n.o(o,a)&&(n.m[a]=o[a]);if(i)var u=i(n)}for(t&&t(l);c<s.length;c++)r=s[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},l=self.webpackChunksim_page_gallery=self.webpackChunksim_page_gallery||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var a=n.O(void 0,[350],(()=>n(467)));a=n.O(a)})();